.\" -*- nroff -*-
.\" Copyright 2002 by Szabolcs Szakacsits  All Rights Reserved.
.\"
.TH NTFSRESIZE 8 "November 2002" "Linux\-NTFS @VERSION@"
.SH NAME
ntfsresize \- resize an NTFS filesystem
.SH SYNOPSIS
.B ntfsresize
[\fB\-fhin\fR]
[\fB\-c
.I clusters\fR]
[\fB\-s	\fIsize\fR[\fBK\fR|\fBM\fR|\fBG\fR]]
.I device
.SH DESCRIPTION
The
.B ntfsresize
program non-destructively resizes Windows NT4, 2000, XP or .NET
NTFS filesystems.  At present it can be used to shrink a
defragmented NTFS filesystem located on an unmounted
.I device
(usually a disk partition). The new volume will have
.I size
bytes.
The
.I size
parameter may have one of the optional modifiers
\fBK\fR, \fBM\fR, \fBG\fR, which means the
.I size
parameter is given in kilo-, mega- or gigabytes respectively.
.PP
The
.B ntfsresize
program does not manipulate the size of partitions.
If you wish to shrink an NTFS partition, first use
.B ntfsresize
to shrink the size of the filesystem. Then you may use
.BR fdisk (8)
to shrink the size of the partition by deleting the
partition and recreating it with the smaller size. 
.PP
.B IMPORTANT!
When recreating the partition with
.BR fdisk (8)
make sure you create it with the same starting
disk cylinder and partition type 
as before and you do not make it smaller than the new size
of the NTFS filesystem! Otherwise you may lose your entire filesystem.
Also make sure you set the bootable flag for the partition if it
existed before. Failing to do so you might not be able to boot your
computer from the disk!
.PP
Note,
.B ntfsresize
schedules 'chkdsk' to make an NTFS consistency check
when you will boot Windows. If your partition was a
system partition than Windows may intentionally reboot after 
the successful consistency check.

.SH OPTIONS
.TP
.B -f
Forces ntfsresize to proceed with the filesystem resize operation, overriding
some safety checks which
.B ntfsresize
normally enforces. You can use this
parameter multiply times if you want to overcome every single safety checks.
.TP
.B -h
Display help and exit.
.TP
.B -i
Using this option you can calculate the smallest shrunken volume size supported.
This option will not make any changes to the filesystem.
.TP
.B -n
You can use this option to make a test run before doing the real resize operation.
Volume will be opened read-only and
.B ntfsresize
displays what it would do if it were to resize the filesystem.
.TP
.B -c \fIclusters
Shrink volume to size given in NTFS
.I clusters\fR.
.TP
.B -s \fIsize\fR[\fBK\fR|\fBM\fR|\fBG\fR]
Shrink volume to \fIsize\fR[\fBK\fR|\fBM\fR|\fBG\fR] bytes.
The optional modifiers \fBK\fR, \fBM\fR, \fBG\fR mean the
.I size
parameter is given in kilo-, mega- or gigabytes respectively.
The corresponding lowercase letters are also accepted.
.SH BUGS
No bugs are known or has been reported so far in the current version.
If you find otherwise, please report it to <linux-ntfs-dev@lists.sf.net>
(no subscription needed). It's also strongly advised you
.B MAKE SURE YOU HAVE A BACKUP
of your important data in case of an unexpected failure.
.PP
Future work is planned to include support for volume enlargement
and resizing fragmented NTFS volumes.
Please note, Windows 2000, XP and .NET have built in NTFS defragmenter.
.SH AVAILABILITY
.B ntfsresize
is part of the linux-ntfs package and is available from
http://linux-ntfs.sf.net/ as source and pre-compiled binary.
.SH AUTHOR
.B ntfsresize
has been written by
Szabolcs Szakacsits <szaka@sienet.hu>.
.SH ACKNOWLEDGEMENT
Many thanks to Anton Altaparmakov and Richard Russon (FlatCap)
for libntfs, excellent documentation, comments, testing and fixes,
moreover to Theodore Ts'o whose
.BR resize2fs (8)
man page formed the basis of this page.
.SH SEE ALSO
.BR fdisk (8),
.BR cfdisk (8),
.BR sfdisk (8),
.BR parted (8),
.BR mkntfs (8)
